# lab-dev configuration example
# This file is generated by 'lab-dev init' and can be customized for your environment

# Repository paths (auto-discovered or manually specified)
repos:
  cbt: ../cbt
  xatuCbt: ../xatu-cbt
  cbtApi: ../cbt-api
  labBackend: ../lab-backend
  lab: ../lab

# Operating mode: "local" or "hybrid"
# - local: All services run locally including Xatu ClickHouse cluster
# - hybrid: External Xatu data source, local transformations and APIs
mode: local

# Networks to enable
# Each network gets its own CBT engine and cbt-api instance
networks:
  - name: mainnet
    enabled: true
    portOffset: 0  # CBT: 8081, cbt-api: 8091
  - name: sepolia
    enabled: false
    portOffset: 1  # CBT: 8082, cbt-api: 8092
  - name: hoodi
    enabled: false
    portOffset: 2  # CBT: 8083, cbt-api: 8093

# Infrastructure configuration
infrastructure:
  clickhouse:
    # Xatu cluster (source data)
    xatu:
      mode: local  # "local" or "external"

# Example: Hybrid mode (local stack with external Xatu data)
# This mode runs CBT cluster, Redis, and Zookeeper locally,
# but connects to an external/production Xatu ClickHouse instance.
#
# Use cases:
#   - Testing with production data locally
#   - Developing CBT transformations against real data
#   - Debugging issues with production datasets
#
# infrastructure:
#   clickhouse:
#     xatu:
#       mode: external
#       # URL formats:
#       #   HTTP:  http://username:password@host:8123
#       #   HTTPS: https://username:password@host:8443
#       #   Native: clickhouse://username:password@host:9000
#       externalUrl: "https://readonly:supersecret@prod-xatu.example.com:8443"
#       externalDatabase: "default"
#       externalUsername: "readonly"
#       externalPassword: "supersecret"
#     cbt:
#       mode: local  # CBT cluster always runs locally

    # CBT cluster (transformations)
    cbt:
      mode: local  # Always local for transformations

  redis:
    port: 6380

  volumes:
    persist: true  # Use named volumes (data survives down/up cycles)
                  # Set to false for clean slate every restart

# Port configuration
ports:
  labBackend: 8080
  labFrontend: 5173
  cbtBase: 8081      # Base port for CBT engines (+ network offset)
  cbtApiBase: 8091  # Base port for cbt-api services (+ network offset)

# Development features
dev:
  labRebuildOnChange: false  # Auto-rebuild lab frontend on changes
  hotReload: true              # Enable hot reload for services that support it
