# CBT Configuration Overrides
#
# This file is deep-merged on top of the xcli-generated CBT configuration.
# You can override ANY CBT config settings, not just models.
#
# HOW IT WORKS:
#   1. xcli generates a base CBT config with sensible defaults
#   2. xcli adds auto-generated model overrides (backfill limits, schedules, etc.)
#   3. Your overrides in this file are deep-merged on top (you win!)
#
# IMPORTANT: Your settings take ULTIMATE precedence. If you override something,
# xcli's auto-generated defaults will NOT be applied for that setting.
#
# Docs: https://github.com/ethpandaops/cbt
#
# ============================================================================
# WARNING: Be careful when overriding settings outside of models.env/overrides!
#
# The following are SAFE to override:
#   - models.env.*        (environment variables for SQL templates)
#   - models.overrides.*  (per-model configuration)
#
# The following are DANGEROUS and may break xcli functionality:
#   - clickhouse.*        (database connections - xcli manages these)
#   - redis.*             (cache connections - xcli manages these)
#   - models.paths        (model discovery - xcli sets these)
#   - metricsAddr         (port conflicts possible)
#   - frontend.addr       (port conflicts possible)
#
# Only override dangerous settings if you know what you're doing!
# ============================================================================

# Model overrides - the safe and common use case
models:
  # Environment variables available in SQL templates via {{ .env.KEY_NAME }}
  #
  # NOTE: When you override models.env, you REPLACE the entire env section.
  # xcli auto-generates these defaults which you'll lose if you override env:
  #   - NETWORK: <network name>
  #   - EXTERNAL_MODEL_MIN_TIMESTAMP: <1 hour ago>
  #   - EXTERNAL_MODEL_MIN_BLOCK: <network-specific>
  #   - MODELS_SCRIPTS_PATH: "../xatu-cbt/models/scripts"
  #
  # If you override env, include MODELS_SCRIPTS_PATH to preserve script functionality.
  env:
    EXTERNAL_MODEL_MIN_TIMESTAMP: "0" # don't limit external models by timestamp
    EXTERNAL_MODEL_MIN_BLOCK: "0" # don't limit external models by block
    MODELS_SCRIPTS_PATH: "../xatu-cbt/models/scripts" # define where to find any script-based models

  overrides:
    # Example: Override a specific model's limits
    fct_block:
      config:
        limits:
          min: 9500000  # Custom start position for this model
        schedules:
          forwardfill: "@every 1m"
          backfill: "@every 5m"

    # Example: Disable an expensive or unwanted model
    fct_address_storage_slot_total:
      enabled: false

    # Example: Override just the schedule for a model
    fct_attestation_first_seen_chunked_50ms:
      config:
        schedules:
          forwardfill: "@every 10s"
          backfill: "@every 2m"

# ============================================================================
# ADVANCED: Full CBT config overrides (use with caution!)
# ============================================================================
#
# You can override ANY CBT setting. Examples:
#
# # Change worker concurrency (safe)
# worker:
#   concurrency: 20
#
# # Change scheduler concurrency (safe)
# scheduler:
#   concurrency: 5
#
# # Override logging level (safe)
# logging: debug
#
# # Override ClickHouse settings (DANGEROUS - may break connectivity)
# clickhouse:
#   queryTimeout: 30m
#
# ============================================================================
# Common scenarios
# ============================================================================
#
# Local development (fast iteration, limited data):
#   models:
#     overrides:
#       fct_block:
#         config:
#           limits:
#             min: 10000000
#             max: 10010000  # Only process 10,000 slots
#
# Testing specific models:
#   models:
#     overrides:
#       model_to_test:
#         config:
#           limits:
#             min: 10000000
#             max: 10001000
#       # Disable all other expensive models
#       other_model:
#         enabled: false
